---
- hosts: all
  become: true
  vars:
    mongodb_disable_thp: true
    mongodb_config:
      security:
        keyFile: /etc/mongodb.keyfile
    mongodb_keyfile_content: ilikerandomsecrets
  roles:
    - role: mongodb
  tasks:
    - name: install test dependencies
      package:
        name: net-tools
        state: present

    - name: flush handlers before testing
      meta: flush_handlers

    - name: wait for exporter ports
      wait_for:
        port: 27017
        delay: 3
        timeout: 30
