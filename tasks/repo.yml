---
- name: add apt key
  apt_key:
    keyserver: "{{ mongodb_apt_keyserver }}"
    id: "{{ mongodb_apt_key_id }}"
  when: ansible_os_family == 'Debian'

- name: add apt repository
  apt_repository:
    filename: mongodb-org-{{ mongodb_version[0:3] }}
    repo: "{{ mongodb_repository[mongodb_version[0:1]] }}"
  when: ansible_os_family == 'Debian'

- name: add yum repository
  yum_repository:
    name: "mongodb-org-{{ mongodb_version[0:3] }}"
    description: MongoDB Repository
    baseurl: "{{ mongodb_repository[mongodb_version[0:1]] }}"
    gpgkey: "{{ 'https://www.mongodb.org/static/pgp/server-' + mongodb_version[0:3] + '.asc' if mongodb_version[0:1] == '3' else omit }}"
    gpgcheck: "{{ 'yes' if mongodb_version[0:1] == '3' else 'no' }}"
    enabled: yes
  when: ansible_os_family == 'RedHat'
